<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Pill Pool</title>
		<link rel="shortcut icon" href="img/favicon.ico">
		<link rel="apple-touch-icon" href="img/touch-icon-iphone.png" /> 
		<link rel="apple-touch-icon" sizes="76x76" href="img/touch-icon-ipad.png" /> 
		<link rel="apple-touch-icon" sizes="120x120" href="img/touch-icon-iphone-retina.png" />
		<link rel="apple-touch-icon" sizes="152x152" href="img/touch-icon-ipad-retina.png" />   
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Kevin Shaffer">
    <meta name="copyright" content="May 2014">
<!--- fooooo -->
		<script src="js/jquery.js"></script>
		<script src="js/jquery-ui.js"></script>		
		<script src="js/bootstrap.min.js"></script>		
		<link href="css/jquery-ui-1.10.4.min.css" rel="stylesheet">
    <link href="css/bootstrap.css" rel="stylesheet">
    <link href="css/bootstrap-theme.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link href="css/sprites.css" rel="stylesheet">
     

<!-- HTML5 shim for IE backwards compatibility -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
</head>
<body>
<div class="container">
	<div class="row"><div class="col-sm-12">
	<br>
		<select class="form-control" style="width:50%;float:right" id="num_balls">
				<option selected disabled value="default">Balls per Player</option>
<!--<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
<option value="13">13</option>
<option value="14">14</option>
<option value="15">15</option>-->
		</select>
		<select class="form-control" style="width:50%;float:left" id="num_players">
		<option selected disabled value="default">Players</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9</option>
<option value="10">10</option>
<option value="11">11</option>
<option value="12">12</option>
<option value="13">13</option>
<option value="14">14</option>
<option value="15">15</option>
		</select><br><br>
		<button class="btn btn-primary btn-block" href="" id="new_game" >New Game</button>
<button onclick="updatePlayerModal(1)" style="display:none"  class="btn btn-default btn-block" id="1" >Show Player 1's Balls</button>
<button onclick="updatePlayerModal(2)" style="display:none"  class="btn btn-success btn-block" id="2" >Show Player 2's Balls</button>
<button onclick="updatePlayerModal(3)" style="display:none"  class="btn btn-default btn-block" id="3" >Show Player 3's Balls</button>
<button onclick="updatePlayerModal(4)" style="display:none"  class="btn btn-success btn-block" id="4" >Show Player 4's Balls</button>
<button onclick="updatePlayerModal(5)" style="display:none"  class="btn btn-default btn-block" id="5" >Show Player 5's Balls</button>
<button onclick="updatePlayerModal(6)" style="display:none"  class="btn btn-success btn-block" id="6" >Show Player 6's Balls</button>
<button onclick="updatePlayerModal(7)" style="display:none"  class="btn btn-default btn-block" id="7" >Show Player 7's Balls</button>
<button onclick="updatePlayerModal(8)" style="display:none"  class="btn btn-success btn-block" id="8" >Show Player 8's Balls</button>
<button onclick="updatePlayerModal(9)" style="display:none"  class="btn btn-default btn-block" id="9" >Show Player 9's Balls</button>
<button onclick="updatePlayerModal(10)" style="display:none"  class="btn btn-success btn-block" id="10" >Show Player 10's Balls</button>
<button onclick="updatePlayerModal(11)" style="display:none"  class="btn btn-default btn-block" id="11" >Show Player 11's Balls</button>
<button onclick="updatePlayerModal(12)" style="display:none"  class="btn btn-success btn-block" id="12" >Show Player 12's Balls</button>
<button onclick="updatePlayerModal(13)" style="display:none"  class="btn btn-default btn-block" id="13" >Show Player 13's Balls</button>
<button onclick="updatePlayerModal(14)" style="display:none"  class="btn btn-success btn-block" id="14" >Show Player 14's Balls</button>
<button onclick="updatePlayerModal(15)" style="display:none"  class="btn btn-default btn-block" id="15" >Show Player 15's Balls</button>
		<br>
		<div  style="text-align:center" class="col-sm-12">
		<span id="allBalls" style="display:none;color:white">Tap ball when potted</span><br><br>
<span onclick='toggleOpacity(1)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball1 ballz ballAnimate'></span>
<span onclick='toggleOpacity(2)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball2 ballz ballAnimate'></span>
<span onclick='toggleOpacity(3)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball3 ballz ballAnimate'></span>
<span onclick='toggleOpacity(4)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball4 ballz ballAnimate'></span>
<span onclick='toggleOpacity(5)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball5 ballz ballAnimate'></span>
<span onclick='toggleOpacity(6)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball6 ballz ballAnimate'></span>
<span onclick='toggleOpacity(7)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball7 ballz ballAnimate'></span>
<span onclick='toggleOpacity(8)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball8 ballz ballAnimate'></span>
<span onclick='toggleOpacity(9)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball9 ballz ballAnimate'></span>
<span onclick='toggleOpacity(10)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball10 ballz ballAnimate'></span>
<span onclick='toggleOpacity(11)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball11 ballz ballAnimate'></span>
<span onclick='toggleOpacity(12)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball12 ballz ballAnimate'></span>
<span onclick='toggleOpacity(13)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball13 ballz ballAnimate'></span>
<span onclick='toggleOpacity(14)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball14 ballz ballAnimate'></span>
<span onclick='toggleOpacity(15)' style='text-align:center;margin:0px 2px 0px 2px;opacity:.25' id='left$i' class='ball15 ballz ballAnimate'></span>
		<br><br>
		
		</div>
<div id="ballDialog" title="Player Balls">
</div>	</div></div>
</div>
<div class="footer">
<small>&copy; 2014 <a href="http://www.kevinashaffer.com">Kevin Shaffer</a></small>
</div>
</body>
<style>
.no-close .ui-dialog-titlebar-close {
  display: none;
}
</style>
<script>
  $(function() {

		$("#num_players").change(function(){
		
	  	var num_players=$("#num_players").val();
	  	var	max_balls = Math.floor(15/num_players);
	  	console.log(max_balls);
	  	for (i=1;i<=15;i++){
		  	$("#num_balls option[value="+String(i)+"]").remove();		  	
	  	}	
	  	for(i=1;i<=max_balls;i++){
				$("#num_balls").append('<option value="'+String(i)+'">'+String(i)+'</option>');			  	
	  	}
		});
    BallsLeft = new Array(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15);

  	$("#new_game").click(Setup);
  	});
  	function Setup(){

	  	num_players=$("#num_players").val();
	  	num_balls=$("#num_balls").val();
	  	if (num_balls*num_players > 15 ){
		  	alert("That's not gonna work!");
		  	$("#num_players option[value=default]").attr('selected', 'selected');
		  	$("#num_balls option[value=default]").attr('selected', 'selected');

				for (j=1;j<=8;j++){
					$("#"+String(j)).hide();
				}	
	  	}
	  	else {
	  	$("#allBalls").show();
	  	$(".ballz").toggleClass("ballAnimate");
			setTimeout(function(){$(".ballz").toggleClass("ballAnimate"),1100});
		  	new_game(num_balls,num_players); 
				for (j=1;j<=15;j++){
					$("#"+String(j)).hide();
				}		
				for (j=1;j<=num_players;j++){
					$("#"+String(j)).show();
				}	
	  	}
  	};
	function toggleOpacity(number){


		var currentOpacity = $(".ball"+String(number)).css('opacity');
		if (currentOpacity === '1' ){
		BallsLeft.removeByValue(number);
		$(".ball"+String(number)).fadeTo(50,.25);
		}
		else {
		BallsLeft.push(number);
		$(".ball"+String(number)).fadeTo(50,1);			
		}
		if (BallsLeft.length===0){
			var r=confirm("New Game?");
			if (r==true){ Setup();}
			
		}

	}
	
	function updatePlayerModal(number){
	
	var balls = String(Players[number].sort(function(a,b){return a - b}))
	//balls = "Your "+keyword+balls.substring(0,balls.length-1).replace(/,/g,', ');
	var body = "";
	for (i=0;i<num_balls;i++){
		var cO = $(".ball"+String(Players[number][i])).css('opacity');
		body+='<span 	style="margin:0px 5px 0px 0px;opacity:'+String(cO)+'" class="ball'+String(Players[number][i])+'"></span>';
	}
$( "#ballDialog" ).dialog({
	position: { my: "center",of:body },
	width:'100%',
	modal:true,
	closeOnEscape:true,
  dialogClass: "no-close",
  buttons: [
    {
      text: "Done",
      click: function() {
        $( this ).dialog( "close" );
      }
    }
  ]
});
$("#ballDialog").html("<br><div style='text-align:center'>"+body+"</div>");	
$('#ballDialog').dialog('option', 'title', 'Player '+number+"'s Balls");

	}
	
  function new_game(num_balls,num_players){
    BallsLeft = new Array(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15);
    for (i=1;i<16;i++){
	    $(".ball"+String(i)).fadeTo("fast",1);		
    }
	  var balls = new Array();
	  for (i=1;i<16;i++){
		  balls[i-1]=i;
	  }
	  Players = new Array();
	  for (j=1;j<=num_players;j++){
	  	Players[j] = new Array();
	  }	
	  for (j=1;j<=num_balls;j++){
	  	for (i=1;i<=num_players;i++) {
	  		var ball = balls[Math.floor(Math.random()*balls.length)];
				balls.removeByValue(ball);
				Players[i][j]=ball;
			}
		}
	}
Array.prototype.removeByValue = function(val) {
    for(var i=0; i<this.length; i++) {
        if(this[i] == val) {
            this.splice(i, 1);
            break;
        }
    }
}

  </script>
</html>